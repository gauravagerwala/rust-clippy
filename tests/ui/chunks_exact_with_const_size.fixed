#![warn(clippy::chunks_exact_with_const_size)]
#![allow(unused)]
#![allow(clippy::iter_cloned_collect)]

fn main() {
    let slice = [1, 2, 3, 4, 5, 6, 7, 8];

    // Should trigger lint - literal constant
    let result = slice.as_chunks::<4>().0.iter();
    //~^ chunks_exact_with_const_size

    // Should trigger lint - const value
    const CHUNK_SIZE: usize = 4;
    let result = slice.as_chunks::<CHUNK_SIZE>().0.iter();
    //~^ chunks_exact_with_const_size

    // Should NOT trigger - runtime value
    let size = 4;
    let mut it = slice.chunks_exact(size);
    for chunk in it {}

    // Should trigger lint - simple iteration
    let result = slice.as_chunks::<3>().0.iter();
    //~^ chunks_exact_with_const_size

    // Should trigger - mutable variant
    let mut arr = [1, 2, 3, 4, 5, 6, 7, 8];
    let result = arr.as_chunks_mut::<4>().0.iter();
    //~^ chunks_exact_with_const_size

    // Should trigger - multiline expression
    #[rustfmt::skip]
    let result = slice
        .iter()
        .copied()
        .collect::<Vec<_>>()
        .as_chunks::<2>().0.iter();
    //~^ chunks_exact_with_const_size
}
